@model ICollection<MessageModel>
@using NeoSistem.Trinnk.Web.Areas.Account.Models
@using NeoSistem.Trinnk.Web.Models

@using NeoSistem.Trinnk.Core.Web.Helpers
@using NeoSistem.Trinnk.Web.Helpers
@using System.Diagnostics
@using NeoSistem.Trinnk.Web.Models.Home
@using NeoSistem.Trinnk.Web.Models.MemberShip
@using NeoSistem.Trinnk.Web.Models.Authentication
@using Trinnk.Entities.Tables.Members
@using NeoSistem.Trinnk.Web.Models.ViewModels
@using NeoSistem.Trinnk.Web.Models.Products
@using NeoSistem.Trinnk.Web.Models.Catalog
@using NeoSistem.Trinnk.Web.Models.Entities
@using NeoSistem.Trinnk.Web.Models.ProductRequests
@using NeoSistem.Trinnk.Web.Models.Stores
@using NeoSistem.Trinnk.Core.Web
@using NeoSistem.Trinnk.Web.Models.StoreNews
@using System.Globalization
@using NeoSistem.Trinnk.Web.Models.StoreProfiles
@using NeoSistem.Trinnk.Web.Models.Videos
@using NeoSistem.Trinnk.Web.Models.Adverts
@using Trinnk.Entities.Tables.Catalog
@using NeoSistem.Trinnk.Web.Areas.Account.Models.Advert
@using NeoSistem.Trinnk.Web.Areas.Account.Models.FavoriteProducts

@{
    //Layout = "~/Views/Shared/_LayoutAccountMaster.cshtml";
    //Layout = "~/Views/Shared/_LayoutMainMaster.cshtml";
    //Layout = "~/Views/Shared/_LayoutStoreProfileMaster.cshtml";


}

@section headercontent{
}


@{ var entities = new TrinnkEntities();
    short index = 0;
}
@foreach (var item in Model)
{
    index++;


    var checkmessage = entities.messagechecks.Where(c => c.MessageId == item.MessageId).Where(c => c.MainPartyId == AuthenticationUser.Membership.MainPartyId).FirstOrDefault();
    if (checkmessage == null)
    {

<tr class="info">
    <td>
        @Html.CheckBox("click")
    </td>
    <td>
        <a href="/Account/Message/Detail/@item.MessageId?RedirectMessageType=@((byte)MessageType.Inbox )">
            @Html.Truncate(item.MainPartyFullName, 22)
        </a>
    </td>
    <td>
        <a href="/Account/Message/Detail/@(item.MessageId)?RedirectMessageType=@((byte)MessageType.Inbox )">
            @{ var subject = entities.Messages.Where(c => c.MessageId == item.MessageId).SingleOrDefault().MessageSubject;

                                    if (subject != null)
                                    {
                @Html.Truncate(subject, 70) } }
        </a>
    </td>
    <td class="hidden-xs">
        @item.MessageDate.ToString("dd.MM.yyyy HH:mm")
    </td>
</tr> }
                else
                {
                    <tr>

                        <td>

                            @Html.CheckBox("click")

                        </td>

                        <td>

                            <a href="/Account/Message/Detail/@(item.MessageId)?RedirectMessageType=@((byte)MessageType.Inbox )">

                                @Html.Truncate(item.MainPartyFullName, 22)

                            </a>

                        </td>

                        <td>

                            <a href="/Account/Message/Detail/@(item.MessageId)?RedirectMessageType=@((byte)MessageType.Inbox )">

                                @{
                                    var subject = entities.Messages.Where(c => c.MessageId == item.MessageId).SingleOrDefault().MessageSubject;

                                    if (subject != null)
                                    {



                                        @Html.Truncate(subject, 70)



                                    }
                                }

                            </a>

                        </td>

                        <td class="hidden-xs">

                            @item.MessageDate.ToString("dd.MM.yyyy HH:mm")

                        </td>
                    </tr>
                }
            } 